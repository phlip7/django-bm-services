{% extends 'base.html' %}
{% load static %}

{% block page %}
    <!-- Hero Section    restaurant-1515164783716-8e6920f3e77c.jpg   img/photo/baramogo-default-gig-1.jpeg --> 
    <section class="pt-7 pb-5 d-flex align-items-end dark-overlay bg-cover" style="background-image: url(/media/{{ gig.cover_image }});">
      <div class="container overlay-content">
        <div class="d-flex justify-content-between align-items-start flex-column flex-lg-row align-items-lg-end">
          <div class="text-white mb-4 mb-lg-0">
            <div class="badge badge-pill badge-transparent px-3 py-2 mb-4"> {{ gig.category }} </div>
            <h1 class="text-shadow verified"> {{ gig.title }} </h1>
            <p><i class="fa-map-marker-alt fas mr-2"></i> {{ gig.city }}, {{ gig.locality }}, {{ gig.area }}, {{ gig.subarea }} / {{ gig.address }} </p>
            <p class="mb-0 d-flex align-items-center">
              <i class="fa fa-xs fa-star text-primary"></i>
              <i class="fa fa-xs fa-star text-primary"></i>
              <i class="fa fa-xs fa-star text-primary"></i>
              <i class="fa fa-xs fa-star text-primary"></i>
              <i class="fa fa-xs fa-star text-gray-200 mr-4"></i> {{ reviews|length }}  Commentaires</p>
          </div>
          <div class="calltoactions"><a class="btn btn-primary" href="#leaveReview" onclick="$('#leaveReview').collapse('show')" data-smooth-scroll>Laisser un commentaire</a></div>
          {% if user == gig.user %}
            <div class="calltoactions"><a class="btn btn-warning" href="{% url 'gig_edit' gig.id %}">Modifier Service</a></div>
          {% endif %}
        </div>
      </div>
    </section>
    <section class="py-6">
      <div class="container">
        <div class="row">
          <div class="col-lg-8">
          
            <!-- About Listing-->
            <div class="text-block">
              <h3 class="mb-3">Description</h3>
              <p class="text-muted"> {{ gig.description }} </p>
              <p class="subtitle text-sm text-primary">TARIF : cfa  {{ gig.price }}</p>
            </div>
            <div class="text-block">

              <!-- Listing Location-->
              <h3 class="mb-4">Localisation</h3>
              <div class="map-wrapper-300 mb-3">
                <div class="h-100" id="detailMap">
  
                {{ geoloc_display  |safe }}
                
                <!--   
                  https://developers.google.com/maps/documentation/embed/get-api-key
                  https://developers.google.com/maps/documentation/embed/map-generator#create-project
                  https://www.sterlingsky.ca/why-you-should-embed-a-google-map-on-your-website/
                -->
                
                </div>
              </div>
            </div>

            <div class="text-block">
              <!-- About the hoster-->
              <div class="media"><img class="avatar avatar-lg mr-4" src="/media/{{ gig.user.profile.avatar }}" alt="">
                <div class="media-body">
                  <p> <span class="h3">Service créé par </span>
                    </br><span class="subtitle text-sm text-primary"> {{ gig.user.first_name }} {{ gig.user.last_name }} </span>
                  </p>
                  <p class="text-muted text-sm mb-2"> {% if gig.user.profile.about %} {{ gig.user.profile.about }} {% else %} <em>profil non renseigné</em> {% endif %} </p>
                  <p class="text-muted text-sm"> Mon SLOGAN : {% if gig.user.profile.slogan %} {{ gig.user.profile.slogan }} {% else %} <em> non renseigné</em> {% endif %}  </p>
                  <p class="text-sm"><a href="{% url 'profile' gig.user.username %}">Voir les autres services de {{ gig.user.first_name }} <i class="fa fa-long-arrow-alt-right ml-2"></i></a></p>
                
                  <p class="mb-2"> <a class="" href="#"> <i class="fa fa-phone mr-3"></i><span class="text-dark"> {{ gig.user.profile.phone }} </span></a></p>
                  <p class="mb-2"> <a class="" href="#"> <i class="fa fa-envelope mr-3"></i><span class="text-dark"> {{ gig.user.email }}  </span></a></p>
                  <p class="mb-2"> <a class="" href="#"> <i class="fa fa-globe mr-3"></i><span class="text-dark"> {% if gig.website_link %}  {{ gig.website_link }} {% else %} -- {% endif %} </span></a></p>
                  <p class="mb-2"> <a class="" href="#"> <i class="fab fa-facebook mr-3"></i><span class="text-dark"> {% if gig.facebook_link %} {{ gig.facebook_link }} {% else %} -- {% endif %}  </span></a></p>
                  <p class="mb-2"> <a class="" href="#"> <i class="fab fa-twitter mr-3"></i><span class="text-dark"> {% if gig.twitter_link %}  {{ gig.twitter_link }} {% else %} -- {% endif %} </span></a></p>
                  <p class="mb-2"> <a class="" href="#"> <i class="fab fa-instagram mr-3"></i><span class="text-dark"> {% if gig.instagram_link %}  {{ gig.instagram_link }} {% else %} -- {% endif %}  </span></a></p>
                
                </div>
              </div>
            </div>

            <div class="text-block">
              <!-- Gallery-->
              <h3 class="mb-4">Galerie</h3>
              <div class="row gallery ml-n1 mr-n1">
                {% for gig_image in gig_images %}
                  <div class="col-lg-4 col-6 px-1 mb-2">
                    <a href="/media/{{ gig_image.image }}">
                      <img class="gig-image" src="/media/{{ gig_image.image }}" alt="...">
                    </a>
                  </div>
                {% endfor %}
                
              </div>
            </div>
            <!-- Amenities-->
            {% comment %} <div class="text-block">
              <h3 class="mb-4">Amenities</h3>
              <ul class="amenities-list list-inline">
                <li class="list-inline-item mb-3">
                  <div class="d-flex align-items-center">
                    <div class="icon-circle bg-secondary mr-2"><i class="fa fa-check"></i></div><span>No smoking</span>
                  </div>
                  
                </li>
                <li class="list-inline-item mb-3">
                  <div class="d-flex align-items-center">
                    <div class="icon-circle bg-secondary mr-2"><i class="fa fa-check"></i></div><span>Parking spaces (paid)</span>
                  </div>
                </li>
                <li class="list-inline-item mb-3">
                  <div class="d-flex align-items-center">
                    <div class="icon-circle bg-secondary mr-2"><i class="fa fa-check"></i></div><span>WiFi</span>
                  </div>
                </li>
              </ul>
            </div> {% endcomment %}
            <div class="text-block">
              <p class="subtitle text-sm text-primary">Commentaires    </p>
              <h5 class="mb-4">Liste des Commentaires </h5>

              {% for review in reviews %}
                <div class="media d-block d-sm-flex review">
                  <div class="text-md-center mr-4 mr-xl-5"><img class="d-block avatar avatar-xl p-2 mb-2" src="/media/{{ review.user.profile.avatar }}" alt=""><span class="text-uppercase text-muted text-sm">Dec 2018</span></div>
                  <div class="media-body">
                    <h6 class="mt-2 mb-1"> {{ review.user.first_name }} {{ review.user.last_name }} </h6>
                    <div class="mb-2">

                      {% with ''|center:review.rating as good_points %}
                      {% for _ in good_points %}
                          <i class="fa fa-xs fa-star text-primary"></i>
                      {% endfor %}
                      {% endwith %}

                      {% with ''|center:review.rating_nb_bad as bad_points %}
                      {% for _ in bad_points %}
                          <i class="fa fa-xs fa-star text-gray-200"></i>
                      {% endfor %}
                      {% endwith %}

                    </div>
                    <p class="text-muted text-sm"> {{ review.comment }} </p>
                  </div>
                </div>
              {% endfor %}


              <div class="py-5">
                <button class="btn btn-outline-primary" type="button" data-toggle="collapse" data-target="#leaveReview" aria-expanded="false" aria-controls="leaveReview">Laisser un commentaire</button>
                <div class="collapse mt-4" id="leaveReview">
                  
                  {% if user and not user.is_anonymous %}
                  <p class="text-muted text-sm">Si tu as déjà reçu les services de <b class="mt-2 mb-1"> {{ gig.user.first_name }} </b>, donnes nous ton avis sur la qualité de ses services  </p>
     
                  <form class="form" id="review-form" method="POST">
                  {% csrf_token %}
                    <div class="row">
                      <div class="col-sm-6">
                        <div class="form-group">
                          <label class="form-label" for="rating">Ta Note *</label>
                          <select class="custom-select focus-shadow-0" name="rating" id="rating" required="required">
                            <option value="5">&#9733;&#9733;&#9733;&#9733;&#9733; (5/5) Excellent</option>
                            <option value="4">&#9733;&#9733;&#9733;&#9733;&#9734; (4/5) Bon</option>
                            <option value="3">&#9733;&#9733;&#9733;&#9734;&#9734; (3/5) Moyen</option>
                            <option value="2">&#9733;&#9733;&#9734;&#9734;&#9734; (2/5) Mauvais</option>
                            <option value="1">&#9733;&#9734;&#9734;&#9734;&#9734; (1/5) Très Mauvais</option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label" for="review">Ton Commentaire *</label>
                      <textarea class="form-control" rows="4" name="comment" id="comment" placeholder="Enter your review"></textarea>
                    </div>
                    <button class="btn btn-primary" type="submit">Publier</button>
                  </form>

                  {% else %}
                  <h5 class="text-sm"><a href="{% url 'signin' %}">Connectes toi d'abord pour laisser un commentaire <i class="fa fa-long-arrow-alt-right ml-2"></i></a></h5>
                  {% endif %}

                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="pl-xl-4">

              <!-- Contact-->
              {% comment %} <div class="card border-0 shadow mb-5">
                <div class="card-header bg-gray-100 py-4 border-0">
                  <div class="media align-items-center">
                    <div class="media-body">
                      <p class="subtitle text-sm text-primary">Je suis joignable ici</p>
                      <h4 class="mb-0">Contact</h4>
                    </div>
                    <svg class="svg-icon svg-icon svg-icon-light w-3rem h-3rem ml-3 text-muted">
                      <use xlink:href="#fountain-pen-1"> </use>
                    </svg>
                  </div>
                </div>
                <div class="card-body">
                  <ul class="list-unstyled mb-4">
                    <li class="mb-2"> <a class="text-gray-00 text-sm text-decoration-none" href="#"><i class="fa fa-user mr-3"></i><span class="text-muted"> {{ gig.user.first_name }} {{ gig.user.last_name }} </span></a></li>
                    <li class="mb-2"> <a class="text-gray-00 text-sm text-decoration-none" href="#"><i class="fa fa-phone mr-3"></i><span class="text-muted"> {{ gig.user.profile.phone }} </span></a></li>
                    <li class="mb-2"> <a class=" text-sm text-decoration-none" href="#"><i class="fa fa-envelope mr-3"></i><span class="text-muted"> {{ gig.user.email }}  </span></a></li>
                    <li class="mb-2"> <a class=" text-sm text-decoration-none" href="#"><i class="fa fa-globe mr-3"></i><span class="text-muted"> {% if gig.website_link %}  {{ gig.website_link }} {% else %} -- {% endif %} </span></a></li>
                    <li class="mb-2"> <a class="text-blue text-sm text-decoration-none" href="#"><i class="fab fa-facebook mr-3"></i><span class="text-muted"> {% if gig.facebook_link %} {{ gig.facebook_link }} {% else %} -- {% endif %}  </span></a></li>
                    <li class="mb-2"> <a class=" text-sm text-decoration-none" href="#"><i class="fab fa-twitter mr-3"></i><span class="text-muted"> {% if gig.twitter_link %}  {{ gig.twitter_link }} {% else %} -- {% endif %} </span></a></li>
                    <li class="mb-2"> <a class=" text-sm text-decoration-none" href="#"><i class="fab fa-instagram mr-3"></i><span class="text-muted"> {% if gig.instagram_link %}  {{ gig.instagram_link }} {% else %} -- {% endif %}  </span></a></li>
                  </ul>
                  <div class="text-center"><a class="btn btn-outline-primary btn-block" href="#"> <i class="far fa-paper-plane mr-2"></i>Send a Message</a></div>
                </div>
              </div> 
              <!-- Opening Hours      -->
              <div class="card border-0 shadow mb-5">
                <div class="card-header bg-gray-100 py-4 border-0">
                  <div class="media align-items-center">
                    <div class="media-body">
                      <p class="subtitle text-sm text-primary">Disponibilité</p>
                      <h4 class="mb-0">Horaire </h4>
                    </div>
                    <svg class="svg-icon svg-icon svg-icon-light w-3rem h-3rem ml-3 text-muted">
                      <use xlink:href="#wall-clock-1"> </use>
                    </svg>
                  </div>
                </div>
                <div class="card-body">
                  <table class="table text-sm mb-0">
                    <tr>
                      <th class="pl-0 border-0">Sunday</th>
                      <td class="pr-0 text-right border-0">8:00 am - 6:00 pm</td>
                    </tr>
                    <tr>
                      <th class="pl-0">Monday</th>
                      <td class="pr-0 text-right">8:00 am - 6:00 pm</td>
                    </tr>
                    <tr>
                      <th class="pl-0">Tuesday</th>
                      <td class="pr-0 text-right">8:00 am - 6:00 pm</td>
                    </tr>
                    <tr>
                      <th class="pl-0">Wednesday</th>
                      <td class="pr-0 text-right">8:00 am - 6:00 pm</td>
                    </tr>
                    <tr>
                      <th class="pl-0">Thursday</th>
                      <td class="pr-0 text-right">8:00 am - 6:00 pm</td>
                    </tr>
                    <tr>
                      <th class="pl-0">Friday</th>
                      <td class="pr-0 text-right">8:00 am - 6:00 pm</td>
                    </tr>
                    <tr>
                      <th class="pl-0">Saturday</th>
                      <td class="pr-0 text-right">Closed</td>
                    </tr>
                  </table>
                </div>
              </div> {% endcomment %}

              {% comment %} <div class="text-center">
                <p><a class="text-secondary" href="#"> <i class="fa fa-heart"></i> Bookmark This Listing</a></p><span>79 people bookmarked this place </span>
              </div> {% endcomment %}
            </div>
          </div>
        </div>
      </div>
    </section>
    <div class="py-6 bg-gray-100">
      <div class="container">
        <h5 class="mb-0">Services similaires</h5>
        <p class="subtitle text-sm text-primary mb-4">Tu pourrais peut-être aussi aimer  </p>
        <!-- Slider main container-->
        <div class="swiper-container swiper-container-mx-negative items-slider">
          <!-- Additional required wrapper-->
          <div class="swiper-wrapper pb-5">
            <!-- Slides-->

            {% for gig_sim in gig_similars %}  
            <div class="swiper-slide h-auto px-2">
              <!-- place item-->
              <div class="w-100 h-100 hover-animate" data-marker-id="{{ gig_sim.id }}">
                <div class="card h-100 border-0 shadow">
                  <div class="card-img-top overflow-hidden gradient-overlay card-gig-image" style="height: 17vw; object-fit: cover;">
                    <img width="100%" height="100%" src="/media/{{ gig_sim.cover_image }}" alt="{{ gig_sim.title }}"/>
                    <a class="tile-link" href="{% url 'gig_detail' gig_sim.id %}"></a>
                    <div class="card-img-overlay-bottom z-index-20">
                      <div class="media text-white text-sm align-items-center">
                        <img class="avatar avatar-border-white mr-2" src="/media/{{ gig_sim.user.profile.avatar }}" alt="{{ gig_sim.title }}"/>
                        <div class="media-body"> {{ gig_sim.user.first_name }}</div>
                      </div>
                    </div>
                    <div class="card-img-overlay-top text-right"><a class="card-fav-icon position-relative z-index-40" href="javascript: void();"> 
                        <svg class="svg-icon text-white">
                          <use xlink:href="#heart-1"> </use>
                        </svg></a></div>
                  </div>
                  <div class="card-body d-flex align-items-center">
                    <div class="w-100">
                      <h6 class="card-title"><a class="text-decoration-none text-dark" href="{% url 'gig_detail' gig_sim.id %}">{{ gig_sim.title|slice:"0:45" }}</a></h6>
                      <div class="d-flex card-subtitle mb-3">
                        <p class="flex-grow-1 mb-0 text-muted text-sm">{{ gig_sim.description|slice:"0:35" }}...</p>
                        <p class="flex-shrink-1 mb-0 card-stars text-xs text-right">
                          <i class="fa fa-star text-warning"></i><i class="fa fa-star text-warning"></i><i class="fa fa-star text-warning"></i><i class="fa fa-star text-warning"></i><i class="fa fa-star text-warning"></i>
                        </p>
                      </div>
                      <p class="card-text text-muted"><span class="h4 text-primary">cfa {{ gig_sim.price }} </span> /h</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}

          </div>
          <!-- If we need pagination-->
          <div class="swiper-pagination"></div>
        </div>
      </div>
    </div>
    {% endblock %}