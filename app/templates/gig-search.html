{% extends 'base.html' %}
{% load static %}

{% block page %}
    <div class="container-fluid pt-5 pb-3 border-bottom px-lg-5">
      <div class="row">
        <div class="col-xl-8">
          <h1>Recherche de services   </h1>
        </div>
      </div>
    </div>

    <div class="container-fluid py-5 px-lg-5">
      <div class="row">
        <div class="col-lg-3 pt-3">

          <form class="pr-xl-3" method="GET" action="#" autocomplete="off">
            <input class="form-control" type="hidden" name="form_id" id="form_id" value="gfilter">
            <div class="mb-4">
              <label class="form-label" for="form_search">Mots clés</label>
              <div class="input-label-absolute input-label-absolute-right">
                <div class="label-absolute"><i class="fa fa-search"></i></div>
                {{ gig_filter.form.title }}
              </div>
            </div>
            <div class="mb-4">
              <label class="form-label" for="form_guests">Categories</label>
              {{ gig_filter.form.category }}
            </div>
            <div class="mb-4">
              <label class="form-label" for="form_type">Pays</label>
              {{ gig_filter.form.country }}
            </div>
            <div class="mb-4">
              <label class="form-label" for="form_type">Ville</label>
              {{ gig_filter.form.city }}
            </div>
            <div class="mb-4">
              <label class="form-label" for="form_type">Quartier</label>
              {{ gig_filter.form.area }}
            </div>

            <div class="pb-4">
              <div class="mb-4">
                <button class="btn btn-primary" type="submit"> <i class="fas fa-filter mr-1"></i>Filter </button>
              </div>
            </div>
          </form>
        </div>

        <div class="col-lg-9">
          <div class="d-flex justify-content-between align-items-center flex-column flex-md-row mb-4">
            <div class="mr-3">
              <p class="mb-3 mb-md-0"><strong> {{ gigs.count }} </strong> resultats trouvés</p>
            </div>
            <div>
              <label class="form-label mr-2" for="form_sort">Trier par</label>
              <select class="selectpicker" name="sort" id="form_sort" data-style="btn-selectpicker" title="">
                <option value="sortBy_0">Most popular   </option>
                <option value="sortBy_1">Recommended   </option>
                <option value="sortBy_2">Newest   </option>
                <option value="sortBy_3">Oldest   </option>
                <option value="sortBy_4">Closest   </option>
              </select>
            </div>
          </div>
          <div class="row">
            <!-- place item-->
            {% for gig in gigs %}
            <div class="col-sm-6 col-xl-4 mb-5 hover-animate" data-marker-id="{{ gig.id }}">
              <div class="card h-100 border-0 shadow">
                <div class="card-img-top overflow-hidden gradient-overlay card-gig-image" style="height: 17vw; object-fit: cover;"> 
                <img width="100%" height="100%" src="/media/{{ gig.cover_image }}" alt="{{ gig.cover_image }}"/>
                  <a class="tile-link" href="{% url 'gig_detail' gig.id %}"></a>
                  <div class="card-img-overlay-bottom z-index-20">
                    <div class="media text-white text-sm align-items-center"><img class="avatar avatar-border-white mr-2" src="/media/{{ gig.user.profile.avatar }}" alt="{{ gig.title }}"/>
                      <div class="media-body"> {{ gig.user.first_name }} </div>
                    </div>
                  </div>
                  <div class="card-img-overlay-top text-right"><a class="card-fav-icon position-relative z-index-40" href="javascript: void();"> 
                      <svg class="svg-icon text-white">
                        <use xlink:href="#heart-1"> </use>
                      </svg></a></div>
                </div>
                <div class="card-body d-flex align-items-center">
                  <div class="w-100">
                    <h6 class="card-title"><a class="text-decoration-none text-dark" href="{% url 'gig_detail' gig.id %}"> {{ gig.title|slice:"0:45" }} </a></h6>
                    <div class="d-flex card-subtitle mb-3">
                      <p class="flex-grow-1 mb-0 text-muted text-sm"> {{ gig.description|slice:"0:35" }}... </p>
                      <p class="flex-shrink-1 mb-0 card-stars text-xs text-right"><i class="fa fa-star text-warning"></i><i class="fa fa-star text-warning"></i><i class="fa fa-star text-warning"></i><i class="fa fa-star text-warning"></i><i class="fa fa-star text-gray-300">                                  </i>
                      </p>
                    </div>
                    <p class="card-text text-muted"><span class="h4 text-primary"> cfa {{ gig.price }} </span> /h </p>
                  </div>
                </div>
              </div>
            </div>

            {% endfor %}

          </div>
          <!-- Pagination -->
          <nav aria-label="Page navigation example">
            <ul class="pagination pagination-template d-flex justify-content-center">
              <li class="page-item"><a class="page-link" href="#"> <i class="fa fa-angle-left"></i></a></li>
              <li class="page-item active"><a class="page-link" href="#">1</a></li>
              <li class="page-item"><a class="page-link" href="#">2</a></li>
              <li class="page-item"><a class="page-link" href="#">3</a></li>
              <li class="page-item"><a class="page-link" href="#"> <i class="fa fa-angle-right"></i></a></li>
            </ul>
          </nav>
        </div>
      </div>
    </div>

  <script>
		//Query All input fields
		var form_fields = document.getElementsByTagName('input')
		for (var field in form_fields){	
			form_fields[field].className += ' form-control pr-4'
		}

    var form_select = document.getElementsByTagName('select')
    for (var sel_field in form_select){	
			form_select[sel_field].className += ' selectpicker form-control'
		}
	</script>

{% endblock %}